---
// Component: WorkStyle.astro
---

<section class="bg-[var(--color-light-blue)] pb-24 md:px-12">
  <div class="max-w-[90%] mx-auto">
    <!-- Mi forma de trabajar -->
    <div class="work-philosophy-section mb-16 text-lg md:text-2xl">
      <h2 class="text-3xl md:text-4xl font-bold text-gulf-blue mb-6 italic">
        Mi forma de trabajar
      </h2>

      <p class="work-text mb-4 leading-relaxed font-plex pb-2 italic">
        He aprendido que un desarrollador no solo resuelve problemas técnicos, sino
        humanos, por eso, antes de escribir una línea de código, escucho,
        pregunto y luego creo.
      </p>

      <p class="work-text font-plex pb-2 mb-6 leading-relaxed italic">
        Mi forma de trabajar se basa en tres principios:
      </p>

      <ul
        class="work-principles list-disc list-inside space-y-3 mb-8 font-plex pb-2 italic"
      >
        <li class="principle-item">
          Entender el problema real, no solo las especificaciones.
        </li>
        <li class="principle-item">
          Presentar soluciones más allá de lo evidente
        </li>
        <li class="principle-item">
          No detenerme cuando algo funciona, sino cuando realmente ayuda.
        </li>
      </ul>

      <p class="work-text italic leading-relaxed font-plex">
        No dejo proyectos a medias. Construyo relaciones de largo plazo, no
        transacciones únicas
      </p>
    </div>

    <!-- Trayectoria Profesional -->
    <div class="experience-section">
      <h2 class="text-3xl md:text-4xl font-bold text-gulf-blue mb-8 italic">
        Trayectoria Profesional
      </h2>

      <div class="space-y-6">
        <!-- Item 1 -->
        <div
          class="experience-card border-b border-[var(--color-blue-deep)] pb-2 cursor-pointer"
          data-experience="exp1"
        >
          <div
            class="w-full flex flex-col md:flex-row justify-between items-start md:items-center mb-4"
          >
            <div class="flex items-start mb-2 md:mb-0 flex-1 gap-4">
              <span
                class="experience-number text-[var(--color-orange)] text-2xl font-bold"
                >(01)</span
              >
              <div>
                <h3 class="font-normal italic text-lg md:text-xl">
                  Centro Universitario UNE - Ingeniero de software
                </h3>
              </div>
            </div>
            <div class="flex items-center gap-4">
              <p class="text-gulf-blue text-sm md:text-base italic font-bold">
                Guadalajara, México (Marzo 2025 - Actualidad)
              </p>
              <svg
                class="arrow-icon w-5 h-5 text-[var(--color-orange)] transition-transform duration-300"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"></path>
              </svg>
            </div>
          </div>
          <div
            class="experience-content overflow-hidden pl-4 md:pl-16 max-h-0 transition-all duration-300 ease-in-out"
          >
            <div class="experience-inner py-2">
              <p class="text-gulf-blue leading-relaxed">
                Responsable del ciclo completo de desarrollo de proyectos, desde
                el levantamiento de requerimientos hasta la implementación y
                despliegue. Dirijo la selección de tecnologías, arquitectura e
                infraestructura de cada proyecto, garantizando soluciones
                escalables y eficientes.
              </p>
            </div>
          </div>
        </div>

        <!-- Item 2 -->
        <div
          class="experience-card border-b border-[var(--color-blue-deep)] pb-2 cursor-pointer"
          data-experience="exp2"
        >
          <div
            class="w-full flex flex-col md:flex-row justify-between items-start md:items-center mb-4"
          >
            <div class="flex items-start mb-2 md:mb-0 flex-1 gap-4">
              <span
                class="experience-number text-[var(--color-orange)] text-2xl font-bold"
                >(02)</span
              >
              <div>
                <h3 class="font-normal italic text-lg md:text-xl">
                  Los Reyes del Injerto - Full Stack Developer y Líder de
                  Proyecto
                </h3>
              </div>
            </div>
            <div class="flex items-center gap-4">
              <p class="text-gulf-blue text-sm md:text-base italic font-bold">
                Ciudad de México, México (Mayo 2024 - Enero 2025)
              </p>
              <svg
                class="arrow-icon w-5 h-5 text-[var(--color-orange)] transition-transform duration-300"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"></path>
              </svg>
            </div>
          </div>
          <div
            class="experience-content overflow-hidden pl-4 md:pl-16 max-h-0 transition-all duration-300 ease-in-out"
          >
            <div class="experience-inner py-2">
              <p class="text-gulf-blue leading-relaxed">
                Gestioné y optimicé un ERP interno utilizando PHP y MySQL.
                Implementé mejoras en la base de datos, desarrollé endpoints
                RESTful API y mejoré la interfaz de usuario con Bootstrap y
                jQuery. Además, supervisé el mantenimiento de servidores y la
                gestión de almacenamiento para garantizar la estabilidad y
                escalabilidad del sistema.
              </p>
            </div>
          </div>
        </div>

        <!-- Item 3 -->
        <div
          class="experience-card border-b border-[var(--color-blue-deep)] pb-2 cursor-pointer"
          data-experience="exp3"
        >
          <div
            class="w-full flex flex-col md:flex-row justify-between items-start md:items-center mb-4"
          >
            <div class="flex items-start mb-2 md:mb-0 flex-1 gap-4">
              <span
                class="experience-number text-[var(--color-orange)] text-2xl font-bold"
                >(03)</span
              >
              <div>
                <h3 class="font-normal italic text-lg md:text-xl">
                  MPYP - Desarrollador Backend
                </h3>
              </div>
            </div>
            <div class="flex items-center gap-4">
              <p class="text-gulf-blue text-sm md:text-base italic font-bold">
                Remoto Agosto 2023 - Diciembre 2023
              </p>
              <svg
                class="arrow-icon w-5 h-5 text-[var(--color-orange)] transition-transform duration-300"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"></path>
              </svg>
            </div>
          </div>
          <div
            class="experience-content overflow-hidden pl-4 md:pl-16 max-h-0 transition-all duration-300 ease-in-out"
          >
            <div class="experience-inner py-2">
              <p class="text-gulf-blue leading-relaxed">
                Trabajé en el desarrollo de aplicaciones robustas utilizando
                Laravel y SQL. Me encargué de la integración de APIs, el manejo
                de autenticación con Laravel Sanctum y la optimización de la
                infraestructura del servidor para mejorar el rendimiento y la
                escalabilidad.
              </p>
            </div>
          </div>
        </div>

        <!-- Item 4 -->
        <div
          class="experience-card border-b border-[var(--color-blue-deep)] pb-2 cursor-pointer"
          data-experience="exp4"
        >
          <div
            class="w-full flex flex-col md:flex-row justify-between items-start md:items-center mb-4"
          >
            <div class="flex items-start mb-2 md:mb-0 flex-1 gap-4">
              <span
                class="experience-number text-[var(--color-orange)] text-2xl font-bold"
                >(04)</span
              >
              <div>
                <h3 class="font-normal italic text-lg md:text-xl">
                  Mirai Innovation Research Institute - Pasante en Desarrollo de
                  Software
                </h3>
              </div>
            </div>
            <div class="flex items-center gap-4">
              <p class="text-gulf-blue text-sm md:text-base italic font-bold">
                Osaka, Japón (Abril 2023 - Julio 2023)
              </p>
              <svg
                class="arrow-icon w-5 h-5 text-[var(--color-orange)] transition-transform duration-300"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"></path>
              </svg>
            </div>
          </div>
          <div
            class="experience-content overflow-hidden pl-4 md:pl-16 max-h-0 transition-all duration-300 ease-in-out"
          >
            <div class="experience-inner py-2">
              <p class="text-gulf-blue leading-relaxed">
                Durante mi pasantía, participé en el desarrollo de una
                plataforma de teleoperación utilizando Node.js y Python.
                Implementé funcionalidades de reconocimiento de objetos y
                optimicé la infraestructura de backend utilizando AWS, lo que
                resultó en un aumento significativo en la eficiencia operativa
                del sistema.
              </p>
            </div>
          </div>
        </div>

        <!-- Item 5 -->
        <div
          class="experience-card border-b border-[var(--color-blue-deep)] pb-2 cursor-pointer"
          data-experience="exp5"
        >
          <div
            class="w-full flex flex-col md:flex-row justify-between items-start md:items-center mb-4"
          >
            <div class="flex items-start mb-2 md:mb-0 flex-1 gap-4">
              <span
                class="experience-number text-[var(--color-orange)] text-2xl font-bold"
                >(05)</span
              >
              <div>
                <h3 class="font-normal italic text-lg md:text-xl">
                  Freelance - Desarrollador Full Stack
                </h3>
              </div>
            </div>
            <div class="flex items-center gap-4">
              <p class="text-gulf-blue text-sm md:text-base italic font-bold">
                Remoto (Enero 2023 - Actualidad )
              </p>
              <svg
                class="arrow-icon w-5 h-5 text-[var(--color-orange)] transition-transform duration-300"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"></path>
              </svg>
            </div>
          </div>
          <div
            class="experience-content overflow-hidden pl-4 md:pl-16 max-h-0 transition-all duration-300 ease-in-out"
          >
            <div class="experience-inner py-2">
              <p class="text-gulf-blue leading-relaxed">
                Como freelance, he desarrollado aplicaciones web utilizando
                React y Node.js. He trabajado en proyectos de desarrollo de
                sistemas de punto de ventas y plataformas de gestión,
                optimizando la experiencia del usuario mediante el uso de
                Material UI y TailwindCSS.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";
  import { SplitText } from "gsap/SplitText";

  const initWorkStyleAnimations = async () => {
  try {
    // Esperar a que las fuentes se carguen
    await document.fonts.ready;

    gsap.registerPlugin(ScrollTrigger, SplitText);

    // Seleccionar elementos de "Mi forma de trabajar"
    const workSection = document.querySelector(".work-philosophy-section");
    const workTexts = document.querySelectorAll(".work-text");
    const principleItems = document.querySelectorAll(".principle-item"); // ✅ CAMBIO AQUÍ

    if (!workSection) {
      console.error("No se encontró la sección de filosofía de trabajo");
      return;
    }

    // Dividir cada texto en palabras
    const textSplits = [];
    workTexts.forEach((text) => {
      const split = new SplitText(text, { type: "words" });
      textSplits.push(split);
      gsap.set(split.words, { opacity: 0, y: 20 });
    });

    // Dividir los principios en palabras
    const principleSplits = [];
    principleItems.forEach((item) => {
      const split = new SplitText(item, { type: "words" });
      principleSplits.push(split);
      gsap.set(split.words, { opacity: 0, y: 20 });
    });

    // Timeline para revelar todo el contenido de filosofía
    const philosophyTimeline = gsap.timeline({
      scrollTrigger: {
        trigger: workSection,
        start: "top 70%",
        end: "bottom 50%",
        scrub: 1,
      },
    });

    // Animar todos los textos secuencialmente
    textSplits.forEach((split, index) => {
      philosophyTimeline.to(
        split.words,
        {
          opacity: 1,
          y: 0,
          duration: 1,
          stagger: 0.04,
          ease: "power2.out",
        },
        index === 0 ? 0 : "-=0.6",
      );
    });

    // Animar los principios
    principleSplits.forEach((split, index) => {
      philosophyTimeline.to(
        split.words,
        {
          opacity: 1,
          y: 0,
          duration: 0.8,
          stagger: 0.03,
          ease: "power2.out",
        },
        "-=0.5",
      );
    });

    console.log("Animaciones de WorkStyle inicializadas correctamente");
  } catch (error) {
    console.error("Error al inicializar animaciones de WorkStyle:", error);
  }
};

  // Funcionalidad de collapse para las experiencias
  document.addEventListener("DOMContentLoaded", () => {
    // Iniciar animaciones
    initWorkStyleAnimations();

    // Funcionalidad de toggle para las cards
    const experienceCards = document.querySelectorAll(".experience-card");

    experienceCards.forEach((card) => {
      card.addEventListener("click", () => {
        const content = card.querySelector(".experience-content");
        const inner = card.querySelector(".experience-inner");
        const arrow = card.querySelector(".arrow-icon");

        // Toggle entre abierto y cerrado
        if (content.style.maxHeight && content.style.maxHeight !== "0px") {
          // Cerrar
          content.style.maxHeight = "0px";
          arrow.style.transform = "rotate(0deg)";
        } else {
          // Abrir
          content.style.maxHeight = inner.scrollHeight + "px";
          arrow.style.transform = "rotate(180deg)";
        }
      });
    });
  });
</script>
